Use ACFVINCR

If Exists (select name from ACFVINCR.sys.sysobjects Where Name = 'TempACFVDetailReports_Compare')
	Drop Table ACFVINCR.dbo.TempACFVDetailReports_Compare

-- Get List of Pagedetailid
Select Pagedetailid
Into ACFVINCR.dbo.TempACFVDetailReports_Compare
From ACFVINCR.dbo.TempACFVDetailReports with (nolock)

If Exists (select name from ACFVINCR.sys.sysobjects Where Name = 'ACFVDetailReports_Old')
	Drop Table ACFVINCR.dbo.ACFVDetailReports_Old

-- Create Blank table 
Select * Into ACFVINCR.dbo.ACFVDetailReports_Old
From MasterACFV.dbo.ACFVDetailReports with (Nolock)
Where 1 = 2

If Exists (select name from ACFVINCR.sys.sysobjects Where Name = 'TempACFVDetailReports_Duplicates')
	Drop Table ACFVINCR.dbo.TempACFVDetailReports_Duplicates

Select pagedetailid Into ACFVINCR.dbo.TempACFVDetailReports_Duplicates
from ACFVINCR.dbo.TempACFVDetailReports Where 1 = 2

Declare @vCnt Bigint = 1 
While (@vCnt > 0 )
Begin
	If Exists (select name from ACFVINCR.sys.sysobjects Where Name = 'TempACFVDetailReports_Compare_1')
		Drop Table ACFVINCR.dbo.TempACFVDetailReports_Compare_1
	
	Select Top 10000 * 
	Into ACFVINCR.dbo.TempACFVDetailReports_Compare_1
	From ACFVINCR.dbo.TempACFVDetailReports_Compare

	Insert Into ACFVINCR.dbo.TempACFVDetailReports_Duplicates(pagedetailid)
	select a.pagedetailid
	from ACFVINCR.dbo.TempACFVDetailReports a
		join MasterACFV.dbo.ACFVDetailReports b with (nolock) on a.pagedetailid = b.pagedetailid
		Join ACFVINCR.dbo.TempACFVDetailReports_Compare_1 c on c.pagedetailid = a.pagedetailid
	where 
	isnull(a.AC_count,'') = isnull(b.AC_count,'')
	and isnull(a.AC_form,'') = isnull(b.AC_form,'')
	and isnull(a.AC_volume,'') = isnull(b.AC_volume,'')
	and isnull(a.ACAdBlockCount,0) = isnull(b.ACAdBlockCount,0)
	and isnull(a.ACAdCompBrandId,0) = isnull(b.ACAdCompBrandId,0)
	and isnull(a.ACAdGrade,'') = isnull(b.ACAdGrade,'')
	and isnull(a.AcAdImage,0) = isnull(b.AcAdImage,0)
	and isnull(a.ACAdvertiserId,0) = isnull(b.ACAdvertiserId,0)
	and isnull(a.ACAttributeName,'') = isnull(b.ACAttributeName,'')
	and isnull(a.ACBlockPixelSize,0) = isnull(b.ACBlockPixelSize,0)
	and isnull(a.ACBrandEquityFlag,0) = isnull(b.ACBrandEquityFlag,0)
	and isnull(a.ACBrandFamily,'') = isnull(b.ACBrandFamily,'')
	and isnull(a.ACBrandFamilyId,0) = isnull(b.ACBrandFamilyId,0)
	and isnull(a.ACCategoryId,0) = isnull(b.ACCategoryId,0)
	and isnull(a.ACCityId,0) = isnull(b.ACCityId,0)
	and isnull(a.ACCouponFlag,0) = isnull(b.ACCouponFlag,0)
	and isnull(a.ACCouponSameWeek,'') = isnull(b.ACCouponSameWeek,'')
	and isnull(a.ACCovid19,'') = isnull(b.ACCovid19,'')
	and isnull(a.ACDigitalSameWeek,'') = isnull(b.ACDigitalSameWeek,'')
	and isnull(a.ACEventName,'') = isnull(b.ACEventName,'')
	and isnull(a.ACFSISameWeek,'') = isnull(b.ACFSISameWeek,'')
	and isnull(a.ACLimtedTimeFlag,'') = isnull(b.ACLimtedTimeFlag,'')
	and isnull(a.ACLinerFlag,'') = isnull(b.ACLinerFlag,'')
	and isnull(a.ACLoyaltyFlag,'') = isnull(b.ACLoyaltyFlag,'')
	and isnull(a.ACMealDealFlag,'') = isnull(b.ACMealDealFlag,'')
	and isnull(a.ACMediaType,'') = isnull(b.ACMediaType,'')
	and isnull(a.ACMultiMfg,'') = isnull(b.ACMultiMfg,'')
	and isnull(a.ACMultiPrd,'') = isnull(b.ACMultiPrd,'')
	and isnull(a.ACMustBuy,'') = isnull(b.ACMustBuy,'')
	and isnull(a.ACNetPriceAfterIncentive,0) = isnull(b.ACNetPriceAfterIncentive,0)
	and isnull(a.ACNewItem,'') = isnull(b.ACNewItem,'')
	and isnull(a.ACPage,0) = isnull(b.ACPage,0)
	and isnull(a.ACpageid,0) = isnull(b.ACpageid,0)
	and isnull(a.ACParentAdcId,0) = isnull(b.ACParentAdcId,0)
	and isnull(a.ACPatchX,'') = isnull(b.ACPatchX,'')
	and isnull(a.ACPrivateBrand,0) = isnull(b.ACPrivateBrand,0)
	and isnull(a.ACProductsFlag,0) = isnull(b.ACProductsFlag,0)
	and isnull(a.ACRebateFlag,'') = isnull(b.ACRebateFlag,'')
	and isnull(a.ACRepflag,0) = isnull(b.ACRepflag,0)
	and isnull(a.ACSegment,'') = isnull(b.ACSegment,'')
	and isnull(a.ACShowMathFlag,'') = isnull(b.ACShowMathFlag,'')
	and isnull(a.AdBlockId,0) = isnull(b.AdBlockId,0)
	and isnull(a.AdCost,0) = isnull(b.AdCost,0)
	and isnull(a.addate,'') = isnull(b.addate,'')
	and isnull(a.AdDay,'') = isnull(b.AdDay,'')
	and isnull(a.AdDayId,'') = isnull(b.AdDayId,'')
	and isnull(a.AdDist,'') = isnull(b.AdDist,'')
	and isnull(a.AdDistId,0) = isnull(b.AdDistId,0)
	and isnull(a.admonth,'') = isnull(b.admonth,'')
	and isnull(a.admonthid,'') = isnull(b.admonthid,'')
	and isnull(a.AdSaleMonth,'') = isnull(b.AdSaleMonth,'')
	and isnull(a.AdSalePeriod,0) = isnull(b.AdSalePeriod,0)
	and isnull(a.AdSaleWeek,0) = isnull(b.AdSaleWeek,0)
	and isnull(a.AdSaleYear,'') = isnull(b.AdSaleYear,'')
	and isnull(a.AdSize,0) = isnull(b.AdSize,0)
	and isnull(a.AdType,'') = isnull(b.AdType,'')
	and isnull(a.AdTYpeID,0) = isnull(b.AdTYpeID,0)
	and isnull(a.advertiser,'') = isnull(b.advertiser,'')
	and isnull(a.advertiserid,0) = isnull(b.advertiserid,0)
	and isnull(a.BackPageInd,0) = isnull(b.BackPageInd,0)
	and isnull(a.bottomrightx,0) = isnull(b.bottomrightx,0)
	and isnull(a.bottomrighty,0) = isnull(b.bottomrighty,0)
	and isnull(a.brand,'') = isnull(b.brand,'')
	and isnull(a.brandid,0) = isnull(b.brandid,0)
	and isnull(a.category,'') = isnull(b.category,'')
	and isnull(a.categoryid,0) = isnull(b.categoryid,0)
	and isnull(a.channel,'') = isnull(b.channel,'')
	and isnull(a.channelid,0) = isnull(b.channelid,0)
	and isnull(a.CircularType,'') = isnull(b.CircularType,'')
	and isnull(a.CircularTypeID,0) = isnull(b.CircularTypeID,0)
	and isnull(a.Comments,0) = isnull(b.Comments,0)
	and isnull(a.Comments1,'') = isnull(b.Comments1,'')
	and isnull(a.Comments2,'') = isnull(b.Comments2,'')
	and isnull(a.Comments3,'') = isnull(b.Comments3,'')
	and isnull(a.Comments4,'') = isnull(b.Comments4,'')
	and isnull(a.country,'') = isnull(b.country,'')
	and isnull(a.countryid,0) = isnull(b.countryid,0)
	and isnull(a.Coupon,0) = isnull(b.Coupon,0)
	and isnull(a.CouponExpirationDate,'') = isnull(b.CouponExpirationDate,'')
	and isnull(a.CouponExpirationDate1,'') = isnull(b.CouponExpirationDate1,'')
	and isnull(a.CouponExpirationDate2,'') = isnull(b.CouponExpirationDate2,'')
	and isnull(a.couponind,0) = isnull(b.couponind,0)
	and isnull(a.CouponValueD1,0) = isnull(b.CouponValueD1,0)
	and isnull(a.CouponValueD2,0) = isnull(b.CouponValueD2,0)
	and isnull(a.CouponValueP1,0) = isnull(b.CouponValueP1,0)
	and isnull(a.CouponValueP2,0) = isnull(b.CouponValueP2,0)
	and isnull(a.CreationMonth,'') = isnull(b.CreationMonth,'')
	and isnull(a.DisplayMedia,'') = isnull(b.DisplayMedia,'')
	and isnull(a.DistDt,'') = isnull(b.DistDt,'')
	and isnull(a.district,'') = isnull(b.district,'')
	and isnull(a.districtid,0) = isnull(b.districtid,0)
	and isnull(a.EnteredClient,0) = isnull(b.EnteredClient,0)
	and isnull(a.event,'') = isnull(b.event,'')
	and isnull(a.eventid,0) = isnull(b.eventid,0)
	and isnull(a.Features,'') = isnull(b.Features,'')
	and isnull(a.featuresid,0) = isnull(b.featuresid,0)
	and isnull(a.firstpageheight,0) = isnull(b.firstpageheight,0)
	and isnull(a.firstpagewidth,0) = isnull(b.firstpagewidth,0)
	and isnull(a.flyerid,0) = isnull(b.flyerid,0)
	and isnull(a.flyerspace,0) = isnull(b.flyerspace,0)
	and isnull(a.FrontPageInd,0) = isnull(b.FrontPageInd,0)
	and isnull(a.FVDisplayPage,'') = isnull(b.FVDisplayPage,'')
	and isnull(a.FVSystemPage,'') = isnull(b.FVSystemPage,'')
	and isnull(a.height,0) = isnull(b.height,0)
	and isnull(a.Illustrated,0) = isnull(b.Illustrated,0)
	and isnull(a.ImageName,'') = isnull(b.ImageName,'')
	and isnull(a.img,'') = isnull(b.img,'')
	and isnull(a.language,'') = isnull(b.language,'')
	and isnull(a.languageid,0) = isnull(b.languageid,0)
	and isnull(a.LowestDiscountPrice,0) = isnull(b.LowestDiscountPrice,0)
	and isnull(a.LowestRebatePrice,0) = isnull(b.LowestRebatePrice,0)
	and isnull(a.MainOffer,'') = isnull(b.MainOffer,'')
	and isnull(a.MainOfferId,0) = isnull(b.MainOfferId,0)
	and isnull(a.manufacturer,'') = isnull(b.manufacturer,'')
	and isnull(a.manufacturerid,0) = isnull(b.manufacturerid,0)
	and isnull(a.market,'') = isnull(b.market,'')
	and isnull(a.marketid,0) = isnull(b.marketid,0)
	and isnull(a.MaximumQuantity,0) = isnull(b.MaximumQuantity,0)
	and isnull(a.McUpdatedOn,'') = isnull(b.McUpdatedOn,'')
	and isnull(a.media,'') = isnull(b.media,'')
	and isnull(a.MediaDetail,'') = isnull(b.MediaDetail,'')
	and isnull(a.MediaDetailId,0) = isnull(b.MediaDetailId,0)
	and isnull(a.mediaid,0) = isnull(b.mediaid,0)
	and isnull(a.merchandisecategory,'') = isnull(b.merchandisecategory,'')
	and isnull(a.merchandisecategoryid,0) = isnull(b.merchandisecategoryid,0)
	and isnull(a.merchandisesubcat,'') = isnull(b.merchandisesubcat,'')
	and isnull(a.merchandisesubcatid,0) = isnull(b.merchandisesubcatid,0)
	and isnull(a.MfrUpdatedOn,'') = isnull(b.MfrUpdatedOn,'')
	and isnull(a.MPVACPromoIncentive,'') = isnull(b.MPVACPromoIncentive,'')
	and isnull(a.MPVACPromoIncentiveId,'') = isnull(b.MPVACPromoIncentiveId,'')
	and isnull(a.MPVOffer,'') = isnull(b.MPVOffer,'')
	and isnull(a.MPVOfferId,'') = isnull(b.MPVOfferId,'')
	and isnull(a.MPVOfferType,'') = isnull(b.MPVOfferType,'')
	and isnull(a.MPVOfferTypeId,'') = isnull(b.MPVOfferTypeId,'')
	and isnull(a.MPVOrigin,'') = isnull(b.MPVOrigin,'')
	and isnull(a.MPVOriginId,'') = isnull(b.MPVOriginId,'')
	and isnull(a.MPVPageEvent,'') = isnull(b.MPVPageEvent,'')
	and isnull(a.MPVPageEventId,'') = isnull(b.MPVPageEventId,'')
	and isnull(a.MPVPageTheme,'') = isnull(b.MPVPageTheme,'')
	and isnull(a.MPVPageThemeId,'') = isnull(b.MPVPageThemeId,'')
	and isnull(a.MPVSKU,'') = isnull(b.MPVSKU,'')
	and isnull(a.MPVSKUId,'') = isnull(b.MPVSKUId,'')
	and isnull(a.MPVSKUType,'') = isnull(b.MPVSKUType,'')
	and isnull(a.MPVSKUTypeId,'') = isnull(b.MPVSKUTypeId,'')
	and isnull(a.MPVVariety,'') = isnull(b.MPVVariety,'')
	and isnull(a.MPVVarietyId,'') = isnull(b.MPVVarietyId,'')
	and isnull(a.MscUpdatedOn,'') = isnull(b.MscUpdatedOn,'')
	and isnull(a.NorPrice,0) = isnull(b.NorPrice,0)
	and isnull(a.NumberPackage,0) = isnull(b.NumberPackage,0)
	and isnull(a.OfferDes,'') = isnull(b.OfferDes,'')
	and isnull(a.Optional1,'') = isnull(b.Optional1,'')
	and isnull(a.Optional10,'') = isnull(b.Optional10,'')
	and isnull(a.Optional11,'') = isnull(b.Optional11,'')
	and isnull(a.Optional12,'') = isnull(b.Optional12,'')
	and isnull(a.Optional2,'') = isnull(b.Optional2,'')
	and isnull(a.Optional3,'') = isnull(b.Optional3,'')
	and isnull(a.Optional4,'') = isnull(b.Optional4,'')
	and isnull(a.Optional5,'') = isnull(b.Optional5,'')
	and isnull(a.Optional6,'') = isnull(b.Optional6,'')
	and isnull(a.Optional7,'') = isnull(b.Optional7,'')
	and isnull(a.Optional8,'') = isnull(b.Optional8,'')
	and isnull(a.Optional9,'') = isnull(b.Optional9,'')
	and isnull(a.ordervalue,0) = isnull(b.ordervalue,0)
	and isnull(a.originalflyerid,'') = isnull(b.originalflyerid,'')
	and isnull(a.OriginalPagedetailid,0) = isnull(b.OriginalPagedetailid,0)
	and isnull(a.OtherDiscountD1,0) = isnull(b.OtherDiscountD1,0)
	and isnull(a.OtherDiscountD2,0) = isnull(b.OtherDiscountD2,0)
	and isnull(a.OtherDiscountD3,0) = isnull(b.OtherDiscountD3,0)
	and isnull(a.OtherDiscountP1,0) = isnull(b.OtherDiscountP1,0)
	and isnull(a.OtherDiscountP2,0) = isnull(b.OtherDiscountP2,0)
	and isnull(a.OtherDiscountP3,0) = isnull(b.OtherDiscountP3,0)
	and isnull(a.page,0) = isnull(b.page,0)
	and isnull(a.pagedetailid,0) = isnull(b.pagedetailid,0)
	and isnull(a.PageName,'') = isnull(b.PageName,'')
	and isnull(a.pages,0) = isnull(b.pages,0)
	and isnull(a.pagespace,0) = isnull(b.pagespace,0)
	and isnull(a.pagetype,'') = isnull(b.pagetype,'')
	and isnull(a.PageTypeId,0) = isnull(b.PageTypeId,0)
	and isnull(a.persona,'') = isnull(b.persona,'')
	and isnull(a.PkgSize,0) = isnull(b.PkgSize,0)
	and isnull(a.PkgSizeId,0) = isnull(b.PkgSizeId,0)
	and isnull(a.ProductTerritory,'') = isnull(b.ProductTerritory,'')
	and isnull(a.ProductTerritoryGroup,'') = isnull(b.ProductTerritoryGroup,'')
	and isnull(a.ProductTerritoryGroupID,0) = isnull(b.ProductTerritoryGroupID,0)
	and isnull(a.ProductTerritoryID,0) = isnull(b.ProductTerritoryID,0)
	and isnull(a.ProductTerritorySubGroup,'') = isnull(b.ProductTerritorySubGroup,'')
	and isnull(a.ProductTerritorySubGroupId,0) = isnull(b.ProductTerritorySubGroupId,0)
	and isnull(a.Promotions,'') = isnull(b.Promotions,'')
	and isnull(a.PtgUpdatedOn,'') = isnull(b.PtgUpdatedOn,'')
	and isnull(a.PtsgUpdatedOn,'') = isnull(b.PtsgUpdatedOn,'')
	and isnull(a.PtUpdatedOn,'') = isnull(b.PtUpdatedOn,'')
	and isnull(a.publication,'') = isnull(b.publication,'')
	and isnull(a.publicationid,0) = isnull(b.publicationid,0)
	and isnull(a.publishedon,'') = isnull(b.publishedon,'')
	and isnull(a.RebateAmount,0) = isnull(b.RebateAmount,0)
	and isnull(a.receiveddt,'') = isnull(b.receiveddt,'')
	and isnull(a.region,'') = isnull(b.region,'')
	and isnull(a.regionid,0) = isnull(b.regionid,0)
	and isnull(a.RegularPrice1,0) = isnull(b.RegularPrice1,0)
	and isnull(a.RegularPrice2,0) = isnull(b.RegularPrice2,0)
	and isnull(a.RequiredQuantity,0) = isnull(b.RequiredQuantity,0)
	and isnull(a.retmktid,0) = isnull(b.retmktid,0)
	and isnull(a.saleenddate,'') = isnull(b.saleenddate,'')
	and isnull(a.SaleEndDt,'') = isnull(b.SaleEndDt,'')
	and isnull(a.SalePrice1,0) = isnull(b.SalePrice1,0)
	and isnull(a.SalePrice2,0) = isnull(b.SalePrice2,0)
	and isnull(a.salestartdate,'') = isnull(b.salestartdate,'')
	and isnull(a.SaleStDt,'') = isnull(b.SaleStDt,'')
	and isnull(a.salesterritory,'') = isnull(b.salesterritory,'')
	and isnull(a.salesterritorygroup,'') = isnull(b.salesterritorygroup,'')
	and isnull(a.salesterritorygroupid,0) = isnull(b.salesterritorygroupid,0)
	and isnull(a.salesterritoryid,0) = isnull(b.salesterritoryid,0)
	and isnull(a.salesterritorysubgroup,'') = isnull(b.salesterritorysubgroup,'')
	and isnull(a.salesterritorysubgroupid,0) = isnull(b.salesterritorysubgroupid,0)
	and isnull(a.size,'') = isnull(b.size,'')
	and isnull(a.SKUDescription1,'') = isnull(b.SKUDescription1,'')
	and isnull(a.SKUDescription1ID,0) = isnull(b.SKUDescription1ID,0)
	and isnull(a.SKUDescription2,'') = isnull(b.SKUDescription2,'')
	and isnull(a.SKUDescription2ID,0) = isnull(b.SKUDescription2ID,0)
	and isnull(a.SKUDescription3,'') = isnull(b.SKUDescription3,'')
	and isnull(a.SKUDescription3ID,0) = isnull(b.SKUDescription3ID,0)
	and isnull(a.SKUType,'') = isnull(b.SKUType,'')
	and isnull(a.SKUTypeId,0) = isnull(b.SKUTypeId,0)
	and isnull(a.Source,'') = isnull(b.Source,'')
	and isnull(a.Spend,0) = isnull(b.Spend,0)
	and isnull(a.subject,'') = isnull(b.subject,'')
	and isnull(a.TaggedCompany,'') = isnull(b.TaggedCompany,'')
	and isnull(a.theme,'') = isnull(b.theme,'')
	and isnull(a.themeid,0) = isnull(b.themeid,0)
	and isnull(a.topleftx,0) = isnull(b.topleftx,0)
	and isnull(a.toplefty,0) = isnull(b.toplefty,0)
	and isnull(a.tradeclass,'') = isnull(b.tradeclass,'')
	and isnull(a.tradeclassid,0) = isnull(b.tradeclassid,0)
	and isnull(a.UnitDiscountPrice,0) = isnull(b.UnitDiscountPrice,0)
	and isnull(a.UnitPrice,0) = isnull(b.UnitPrice,0)
	and isnull(a.UnitType,'') = isnull(b.UnitType,'')
	and isnull(a.UnitTypeId,0) = isnull(b.UnitTypeId,0)
	and isnull(a.VehicleId,0) = isnull(b.VehicleId,0)
	and isnull(a.weekof,'') = isnull(b.weekof,'')
	and isnull(a.weekofi,'') = isnull(b.weekofi,'')
	and isnull(a.weekofn,'') = isnull(b.weekofn,'')
	and isnull(a.Weight,0) = isnull(b.Weight,0)
	and isnull(a.width,0) = isnull(b.width,0)

	Delete a
	From ACFVINCR.dbo.TempACFVDetailReports_Compare a join ACFVINCR.dbo.TempACFVDetailReports_Compare_1 b
	On a.pagedetailid = b.pagedetailid

	Set @vCnt = (Select Count(1) From ACFVINCR.dbo.TempACFVDetailReports_Compare)

	Print 'Pending ' + Convert(varchar, @vCnt)
End

If Exists (select name from ACFVINCR.sys.sysobjects Where Name = 'TempACFVDetailReports_Compare_1')
		Drop Table ACFVINCR.dbo.TempACFVDetailReports_Compare_1