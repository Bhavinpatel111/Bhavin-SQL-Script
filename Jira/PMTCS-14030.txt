
--1st Tab- Ad Block ReportData points: Retailer, Market, Ad Date, Ad Block ID, Number of products per ad block
--## Report 1
select Advertiser, Market, AdDate, AdBlockId, count(pagedetailid) [Number of products per ad block]
from ACFVdetailReports where media ='Weekly Ad'
and AdDate between '09/13/2020' and '09/11/2021'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
group by Advertiser, Market, AdDate, AdBlockId
order by Advertiser, Market, AdDate, AdBlockId


--## Report 2
select Advertiser, Market, AdDate, AdBlockId, count(pagedetailid) [Number of products per ad block]
from ACFVdetailReports where media ='Weekly Ad'
and AdDate between '09/09/2018' and '09/07/2019'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
group by Advertiser, Market, AdDate, AdBlockId
order by Advertiser, Market, AdDate, AdBlockId


--2rd Tab- Ad Report
--Retailer, Market, Ad Date, Page ID, Number of ad blocks per page

--## Report 1

select Advertiser, Market, AdDate, Page [Page ID], count(AdBlockId) [Number of ad blocks per page]
from ACFVdetailReports where media ='Weekly Ad'
and AdDate between '09/13/2020' and '09/11/2021'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
group by Advertiser, Market, AdDate, page  

--## Report 2

select Advertiser, Market, AdDate, Page [Page ID], count(AdBlockId) [Number of ad blocks per page]
from ACFVdetailReports where media ='Weekly Ad'
and AdDate between '09/09/2018' and '09/07/2019'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
group by Advertiser, Market, AdDate, page  

--3rd Tab- Ad Report
--Data points: Retailer, Market, Ad Date, Unique Ad ID, Number of pages per ad

--## Report 1

select Advertiser, Market, AdDate, OriginalFlyerID [Unique Ad ID], pages [Number of pages per ad]
from ACFVFlyerReports where media ='Weekly Ad'
and AdDate between '09/13/2020' and '09/11/2021'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
order by Advertiser, Market, AdDate, OriginalFlyerID 

--## Report 2

select Advertiser, Market, AdDate, OriginalFlyerID [Unique Ad ID], pages [Number of pages per ad]
from ACFVFlyerReports where media ='Weekly Ad'
and AdDate between '09/09/2018' and '09/07/2019'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
order by Advertiser, Market, AdDate, OriginalFlyerID 



#########################################################################
# Report 2 Data missing query, Get data from history table 
#########################################################################

use MasterACFVHistory
go

--1st Tab- Ad Block ReportData points: Retailer, Market, Ad Date, Ad Block ID, Number of products per ad block
--## Report 2
select Advertiser, Market, AdDate, AdBlockId, count(pagedetailid) [Number of products per ad block]
from ACFVdetailReports where media ='Weekly Ad'
and AdDate between '09/01/2018' and '09/30/2018'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
group by Advertiser, Market, AdDate, AdBlockId
order by Advertiser, Market, AdDate, AdBlockId


--2rd Tab- Ad Report
--Retailer, Market, Ad Date, Page ID, Number of ad blocks per page
--## Report 2

select Advertiser, Market, AdDate, Page [Page ID], count(AdBlockId) [Number of ad blocks per page]
from ACFVdetailReports where media ='Weekly Ad'
and AdDate between '09/01/2018' and '09/30/2018'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
group by Advertiser, Market, AdDate, page  

--3rd Tab- Ad Report
--Data points: Retailer, Market, Ad Date, Unique Ad ID, Number of pages per ad
--## Report 2

select Advertiser, Market, AdDate, OriginalFlyerID [Unique Ad ID], pages [Number of pages per ad]
from ACFVFlyerReports where media ='Weekly Ad'
and AdDate between '09/01/2018' and '09/30/2018'
and ((Advertiser ='Acme Markets (NAI)' and market = 'Newark, NJ') or
	(Advertiser ='Aldi' and market = 'Randolph, NJ') or
	(Advertiser ='BJ''s Wholesale Club' and market = 'Edgewater, NJ') or
	(Advertiser ='Costco Wholesale' and market = 'Edgewater, NJ') or
	(Advertiser ='Fairway Markets' and market = 'New York, NY') or
	(Advertiser ='Giant Food Carlisle' and market = 'Exton, PA') or
	(Advertiser ='Lidl' and market = 'Edgewater, NJ') or
	(Advertiser ='ShopRite' and market = 'Randolph, NJ') or
	(Advertiser ='Stop & Shop' and market = 'Randolph, NJ') or
	(Advertiser ='Target Stores' and market = 'Edgewater, NJ') or
	(Advertiser ='The Fresh Grocer' and market = 'Philadelphia, PA') or
	(Advertiser ='Walmart' and market = 'Edgewater, NJ') or
	(Advertiser ='Wegmans' and market = 'Philadelphia, PA'))
order by Advertiser, Market, AdDate, OriginalFlyerID 